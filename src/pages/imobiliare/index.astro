---
import Layout from '../../layouts/Layout.astro';
import WhatsAppButton from '../../components/WhatsAppButton.astro';
---

<Layout title="Chirie vs. RatÄƒ | Manualul.ro" description="ComparÄƒ direct costul lunar È™i profitul pe termen lung Ã®ntre chirie È™i ratÄƒ.">
    <main class="max-w-5xl mx-auto px-4 pb-32">
        <nav class="py-6">
            <a href="/" class="text-sm font-bold text-indigo-600 hover:underline flex items-center gap-2">â† Ãnapoi</a>
        </nav>

        <header class="mb-12 text-center">
            <h1 class="text-4xl font-black text-gray-900 mb-2">Chirie vs. RatÄƒ</h1>
            <p class="text-gray-500 font-medium text-lg">SeparÄƒm cheltuielile de profit.</p>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
            <div class="lg:col-span-4 space-y-6 bg-white p-6 rounded-3xl border border-gray-100 shadow-sm">
                <h3 class="font-black uppercase text-xs tracking-widest text-indigo-600">Configurare</h3>
                <div>
                    <label class="block text-xs font-bold text-gray-400 mb-2 uppercase">PreÈ› Apartament (EUR)</label>
                    <input type="number" id="pret" value="100000" class="w-full bg-gray-50 border-2 border-gray-100 rounded-xl p-3 font-black outline-none focus:border-indigo-500">
                </div>
                <div>
                    <label class="block text-xs font-bold text-gray-400 mb-2 uppercase">Chirie LunarÄƒ (EUR)</label>
                    <input type="number" id="chirie" value="500" class="w-full bg-gray-50 border-2 border-gray-100 rounded-xl p-3 font-black outline-none focus:border-indigo-500">
                </div>
                <div>
                    <label class="block text-xs font-bold text-gray-400 mb-2 uppercase">DobÃ¢ndÄƒ AnualÄƒ (%)</label>
                    <input type="number" id="dobanda" value="5.5" step="0.1" class="w-full bg-gray-50 border-2 border-gray-100 rounded-xl p-3 font-black outline-none focus:border-indigo-500">
                </div>
                <div>
                    <label class="block text-xs font-bold text-gray-400 mb-2 uppercase">PerioadÄƒ (Ani)</label>
                    <input type="number" id="ani" value="20" class="w-full bg-gray-50 border-2 border-gray-100 rounded-xl p-3 font-black outline-none focus:border-indigo-500">
                </div>
            </div>

            <div class="lg:col-span-8 space-y-8">
                
                <section class="bg-white rounded-[32px] border border-gray-100 p-8 shadow-sm">
                    <h2 class="text-xl font-black mb-6 flex items-center gap-2">ğŸ’³ 1. CÃ¢t plÄƒteÈ™ti Ã®n fiecare lunÄƒ?</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="p-6 bg-gray-50 rounded-2xl border-l-4 border-indigo-500">
                            <p class="text-xs font-bold text-gray-400 uppercase">RatÄƒ BancarÄƒ</p>
                            <p id="resRata" class="text-3xl font-black text-gray-900">0 EUR</p>
                        </div>
                        <div class="p-6 bg-gray-50 rounded-2xl border-l-4 border-gray-300">
                            <p class="text-xs font-bold text-gray-400 uppercase">Chirie</p>
                            <p id="resChirie" class="text-3xl font-black text-gray-900">0 EUR</p>
                        </div>
                    </div>
                </section>

                <section class="bg-indigo-900 text-white rounded-[32px] p-8 shadow-xl relative overflow-hidden">
                    <h2 class="text-xl font-black mb-6 relative z-10 text-indigo-200">ğŸ’° 2. Cu ce rÄƒmÃ¢i dupÄƒ <span class="dispAni">20</span> ani?</h2>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 relative z-10">
                        <div class="space-y-4">
                            <div class="bg-white/10 p-6 rounded-2xl border border-white/10">
                                <p class="text-xs font-bold uppercase opacity-60">Valoare Proprietate</p>
                                <p id="resCasa" class="text-3xl font-black text-white">0 EUR</p>
                                <p class="text-[10px] mt-2 opacity-50 italic">Calculat la o creÈ™tere de 2% / an a pieÈ›ei.</p>
                            </div>
                        </div>

                        <div class="space-y-4">
                            <div class="bg-indigo-500/30 p-6 rounded-2xl border border-indigo-400/30">
                                <p class="text-xs font-bold uppercase text-indigo-200">InvestiÈ›ie DiferenÈ›Äƒ</p>
                                <p id="resInvest" class="text-3xl font-black text-indigo-300">0 EUR</p>
                                <p class="text-[10px] mt-2 text-indigo-200/60 italic">DacÄƒ investeÈ™ti avansul + diferenÈ›a (RatÄƒ-Chirie) la un randament de 8% / an.</p>
                            </div>
                        </div>
                    </div>

                    <div id="verdict" class="mt-8 p-4 bg-white text-indigo-900 rounded-2xl text-center font-black uppercase tracking-tight relative z-10">
                        CalculÄƒm...
                    </div>
                </section>

                <div class="max-w-md mx-auto">
                    <WhatsAppButton idDesktop="whatsappBtn" idMobile="whatsappBtnFloating" class="mt-8" />
                </div>

            </div>
        </div>
    </main>

    <script is:inline>
        const btnWhatsapp = document.getElementById('whatsappBtn');
        const btnWhatsappFloating = document.getElementById('whatsappBtnFloating');

        function calculate() {
            const pret = parseFloat(document.getElementById('pret').value) || 0;
            const chirie = parseFloat(document.getElementById('chirie').value) || 0;
            const dobandaAn = (parseFloat(document.getElementById('dobanda').value) || 0) / 100 / 12;
            const ani = parseInt(document.getElementById('ani').value) || 1;
            const luni = ani * 12;

            const avans = pret * 0.15;
            const sumaCredit = pret - avans;

            // 1. Calcul Rata
            const rata = sumaCredit * (dobandaAn * Math.pow(1 + dobandaAn, luni)) / (Math.pow(1 + dobandaAn, luni) - 1);
            
            // 2. ProiecÈ›ie Proprietate (2% apreciere/an)
            const valoareCasa = pret * Math.pow(1 + 0.02, ani);

            // 3. ProiecÈ›ie InvestiÈ›ie (8% randament/an = 0.66%/lunÄƒ)
            const rInv = 0.08 / 12;
            let totalInvestit = avans * Math.pow(1 + rInv, luni);
            const diferenta = rata - chirie;

            if (diferenta > 0) {
                // DacÄƒ rata e mai mare, investim diferenÈ›a care altfel s-ar fi dus la bancÄƒ
                totalInvestit += diferenta * (Math.pow(1 + rInv, luni) - 1) / rInv;
            }

            // UI Update
            document.getElementById('resRata').innerText = Math.round(rata).toLocaleString() + " â‚¬";
            document.getElementById('resChirie').innerText = Math.round(chirie).toLocaleString() + " â‚¬";
            document.getElementById('resCasa').innerText = Math.round(valoareCasa).toLocaleString() + " â‚¬";
            document.getElementById('resInvest').innerText = Math.round(totalInvestit).toLocaleString() + " â‚¬";
            document.querySelectorAll('.dispAni').forEach(el => el.innerText = ani);

            const v = document.getElementById('verdict');
            let winnerText = "";
            if(valoareCasa > totalInvestit) {
                winnerText = "Casa";
                v.innerText = "â­ Imobiliarul CÃ¢È™tigÄƒ: Casa valoreazÄƒ mai mult decÃ¢t investiÈ›ia.";
            } else {
                winnerText = "Chiria + InvestiÈ›ia";
                v.innerText = "ğŸ“ˆ InvestiÈ›ia CÃ¢È™tigÄƒ: Ai mai mulÈ›i bani dacÄƒ stai Ã®n chirie È™i investeÈ™ti.";
            }

            // WhatsApp Update
            const mesaj = `Am aflat cÄƒ ${winnerText} este mai rentabilÄƒ pentru mine pe Manualul.ro! ğŸ  Vezi È™i tu: ${window.location.href}`;
            const link = `https://api.whatsapp.com/send?text=${encodeURIComponent(mesaj)}`;

            if (btnWhatsapp) btnWhatsapp.href = link;
            if (btnWhatsappFloating) btnWhatsappFloating.href = link;
        }

        ['pret', 'chirie', 'dobanda', 'ani'].forEach(id => document.getElementById(id).addEventListener('input', calculate));
        calculate();
    </script>
</Layout>