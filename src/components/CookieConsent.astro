---
---
<div id="cookie-banner" class="fixed bottom-0 left-0 w-full bg-white border-t border-gray-200 shadow-[0_-10px_40px_rgba(0,0,0,0.1)] p-6 z-[60] hidden flex-col md:flex-row items-center justify-between gap-4">
    <div class="text-sm text-gray-600 max-w-3xl">
        <p class="font-bold text-gray-900 mb-1">ğŸª Politica de ConfidenÈ›ialitate</p>
        <p>
            Folosim cookie-uri pentru a analiza traficul È™i pentru a Ã®mbunÄƒtÄƒÈ›i experienÈ›a pe Manualul.ro. 
            Datele sunt anonimizate prin Google Analytics.
        </p>
    </div>
    <div class="flex gap-3 w-full md:w-auto">
        <button id="btn-reject" class="flex-1 md:flex-none px-6 py-2.5 rounded-xl border border-gray-300 text-gray-700 font-bold hover:bg-gray-50 transition text-sm">
            Refuz
        </button>
        <button id="btn-accept" class="flex-1 md:flex-none px-6 py-2.5 rounded-xl bg-blue-600 text-white font-bold hover:bg-blue-700 transition text-sm shadow-lg shadow-blue-200">
            Accept
        </button>
    </div>
</div>

<script is:inline>
    // ID-ul tÄƒu Google Analytics
    const GA_ID = 'G-F58T7Y0Y8K';

    const banner = document.getElementById('cookie-banner');
    const btnAccept = document.getElementById('btn-accept');
    const btnReject = document.getElementById('btn-reject');

    // FuncÈ›ia care Ã®ncarcÄƒ efectiv Google Analytics
    function loadGoogleAnalytics() {
        // 1. InserÄƒm scriptul extern
        const script = document.createElement('script');
        script.src = `https://www.googletagmanager.com/gtag/js?id=${GA_ID}`;
        script.async = true;
        document.head.appendChild(script);

        // 2. ConfigurÄƒm dataLayer
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', GA_ID);

        console.log('âœ… GA4 Loaded via Cookie Consent');
    }

    // VerificÄƒm ce a decis utilizatorul Ã®n trecut
    const consent = localStorage.getItem('manualul_consent');

    if (consent === 'granted') {
        loadGoogleAnalytics();
    } else if (consent === 'denied') {
        // Nu facem nimic, respectÄƒm decizia
    } else {
        // Nu a decis Ã®ncÄƒ -> ArÄƒtÄƒm bannerul
        banner.classList.remove('hidden');
        banner.classList.add('flex');
    }

    // Eveniment: ACCEPT
    btnAccept.addEventListener('click', () => {
        localStorage.setItem('manualul_consent', 'granted');
        banner.classList.add('hidden');
        loadGoogleAnalytics(); // Pornim tracking-ul acum
    });

    // Eveniment: REFUZ
    btnReject.addEventListener('click', () => {
        localStorage.setItem('manualul_consent', 'denied');
        banner.classList.add('hidden');
        // Nu Ã®ncÄƒrcÄƒm nimic
    });
</script>